<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The Loyal Ledger</title>
  <link rel="stylesheet" href="/style.css" />
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
</head>
<body class="min-h-screen bg-gray-100 p-4 flex flex-col">
  <div class="flex-1 bg-white shadow-[0_0_25px_rgba(0,0,0,0.25)]">
    <header class="border-b-2 border-stone-300 sticky top-0 bg-white z-40">
      <div class="w-full px-3 sm:px-4 lg:px-6">
        <div class="py-4 text-center border-b border-stone-200">
          <h1 class="text-3xl sm:text-4xl font-serif font-bold text-gray-900 tracking-tight">
            THE LOYAL LEDGER
          </h1>
          <p class="mt-1 text-xs text-gray-600 uppercase tracking-widest">
            A Chronicle of Thoughts & Creativity
          </p>
        </div>
        <nav class="flex justify-center" hx-target="main" hx-select="main" hx-swap="innerHTML">
          <ul class="flex">
            <li>
              <a
                href="/"
                hx-get="/"
                hx-push-url="/"
                data-nav-path="/"
                class="nav-link inline-block px-6 py-3 text-xs font-medium uppercase tracking-wider transition-colors duration-200 text-gray-700"
              >
                Home
              </a>
            </li>
            <li>
              <a
                href="/blog/"
                hx-get="/blog/"
                hx-push-url="/blog/"
                data-nav-path="/blog/"
                class="nav-link inline-block px-6 py-3 text-xs font-medium uppercase tracking-wider transition-colors duration-200 text-gray-700"
              >
                Blog
              </a>
            </li>
            <li>
              <a
                href="/songs/"
                hx-get="/songs/"
                hx-push-url="/songs/"
                data-nav-path="/songs/"
                class="nav-link inline-block px-6 py-3 text-xs font-medium uppercase tracking-wider transition-colors duration-200 text-gray-700"
              >
                Songs
              </a>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main class="w-full px-3 sm:px-4 lg:px-6 py-6">
      <div class="max-w-6xl mx-auto prose prose-serif [&_p]:mb-4 [&_h1+p]:mt-0 [&_h1]:text-3xl [&_h1]:font-serif [&_h1]:tracking-tight [&_h1]:mb-2 [&_h2]:text-xl [&_h2]:font-serif [&_h2]:tracking-tight [&_h2]:mt-4 [&_h2]:mb-1">
        {{ content | safe }}
      </div>
    </main>
  </div>

  <script>
    function updateNavActive() {
      const currentPath = window.location.pathname;
      document.querySelectorAll('.nav-link').forEach(link => {
        const linkPath = link.getAttribute('data-nav-path');
        const isActive = currentPath === linkPath || 
                         (linkPath !== '/' && currentPath.startsWith(linkPath));
        link.classList.toggle('bg-gray-900', isActive);
        link.classList.toggle('text-white', isActive);
        link.classList.toggle('text-gray-700', !isActive);
        link.classList.toggle('hover:bg-gray-100', !isActive);
      });
    }
    function setActiveByPath(path) {
      document.querySelectorAll('.nav-link').forEach(link => {
        const linkPath = link.getAttribute('data-nav-path');
        const isActive = path === linkPath || 
                         (linkPath !== '/' && path.startsWith(linkPath));
        link.classList.toggle('bg-gray-900', isActive);
        link.classList.toggle('text-white', isActive);
        link.classList.toggle('text-gray-700', !isActive);
        link.classList.toggle('hover:bg-gray-100', !isActive);
      });
    }
    updateNavActive();
    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        setActiveByPath(link.getAttribute('data-nav-path'));
      });
    });
    document.body.addEventListener('htmx:pushedIntoHistory', updateNavActive);
  </script>
</body>
</html>